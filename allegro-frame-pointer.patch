--- allegro-4.1.11/configure.in.old	Mon Sep 29 22:49:10 2003
+++ allegro-4.1.11/configure.in	Mon Sep 29 22:52:02 2003
@@ -213,7 +213,7 @@
 elif test "X$allegro_build_profiling_programs" = "Xyes"; then
   COMPILE_PROGRAM=COMPILE_PROFILE
   COMPILE_S_PROGRAM=COMPILE_S_PROFILE
-  PROG_LDFLAGS="-pg \$(LDFLAGS)"
+  PROG_LDFLAGS="-fno-omit-frame-pointer -pg \$(LDFLAGS)"
   LIB_TO_LINK=allp
   PLUGIN_LIB=lib/unix/libapdat.a
   allegro_build_profiling_library=yes
@@ -654,7 +654,7 @@
      ALLEGRO_DEBUG_CFLAGS="$ALLEGRO_DEBUG_CFLAGS -DFORTIFY"
   fi
   CFLAGS="$CFLAGS $TARGET_ARCH"
-  ALLEGRO_PROFILE_CFLAGS="$CFLAGS -pg $WFLAGS"
+  ALLEGRO_PROFILE_CFLAGS="$CFLAGS -fno-omit-frame-pointer -pg $WFLAGS"
   ALLEGRO_SFLAGS="-x assembler-with-cpp"
   ALLEGRO_SHAREDLIB_CFLAGS="-fPIC -DALLEGRO_SHARED"
 else
